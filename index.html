<!doctype html>
<html><head><style>
canvas#myCanvas {
	border:1px solid black;
}
</style></head><body>
<center><canvas id="myCanvas"/></center>
</body><script>

var Square = function (x,y,w,h,vx,vy,bounce,color) {
	this.x = x;
	this.y = y;
	this.w = w;
	this.h = h;
	this.vx = vx;
	this.vy = vy;
	this.bounce = bounce;
	this.color = "#" + color;
};
Square.prototype.draw = function (context) {
	context.beginPath();
	context.lineWidth = "2";
	context.strokeStyle = this.color;
	context.rect(this.x,this.y,this.w,this.h);
	context.closePath();
	context.stroke();
}

var Circle = function (x,y,r,vx,vy,bounce,color) {
	this.x = Math.floor(x);
	this.y = Math.floor(y);
	this.r = r;
	this.vx = vx;
	this.vy = vy;
	this.bounce = bounce;
	this.color = "#" + color;	
}
Circle.prototype.draw = function (context) {
	context.beginPath();
	context.lineWidth = "1";
	context.strokeStyle = this.color;
	context.arc(this.x,this.y,this.r,0,2*Math.PI);
	context.closePath();
	context.stroke();
}

var canvas = document.getElementById("myCanvas");
canvas.height = 600;
canvas.width = 800;
var canvasContext = canvas.getContext("2d");
var squares = [];
for (var i = 0; i <= 200; i++) {
	squares.push(
		new Circle(
			Math.random()*canvas.width,
			Math.random()*canvas.height,
			10,
			Math.random()*10-5,
			Math.random()*10-5,
			-1,
			(Math.random()*0xffffff<<0).toString(16)
		)
	);
}

var CircleToCircleCollision = function (circle1,circle2) {
	var dx = circle1.x - circle2.x;
	var dy = circle1.y - circle2.y;
	var d = Math.sqrt((dx * dx) + (dy * dy));
	return d <= (circle1.r + circle2.r);
}

function update() {
	canvas.width = canvas.width;
	for (var i in squares) {
		var s = squares[i];
		s.x += s.vx;
		s.y += s.vy;

		if (s.x > (canvas.width - (s.r))) {
			s.x = canvas.width - s.r;
			s.vx *= s.bounce;
		} else if ((s.x - s.r) < 0) {
			s.x = s.r;
			s.vx *= s.bounce;
		}

		if (s.y > (canvas.height - s.r)) {
			s.y = canvas.height - s.r;
			s.vy *= s.bounce;
		} else if ((s.y - s.r) < 0) {
			s.y = s.r;
			s.vy *= s.bounce;
		}

		for (var j in squares) {
			var t = squares[j];
			if (i != j) {
				if (CircleToCircleCollision(s,t)) {
					s.vx *= s.bounce;
					s.x += s.vx;

					t.vx *= t.bounce;
					t.x += t.vx;

					s.vy *= s.bounce;
					s.y += s.vy;

					t.vy *= t.bounce;
					t.y += t.vy;
				}
			}
		}
		s.draw(canvasContext);
	}
}
window.setInterval(update,10);
</script></html>






































